---
// Blog Index Page (localized)
import Layout from '../../../layouts/Layout.astro'
import Hero from '../../../components/blocks/hero/PageHeader.astro'
import BlogPosts from '../../../components/blocks/blog/BlogPosts.astro'
import { getCollection } from 'astro:content'
import { isValidLanguage, defaultLanguage } from '../../../config/i18n'

const { lang } = Astro.params
if (!lang || !isValidLanguage(lang)) {
  return Astro.redirect(`/${defaultLanguage}/blog`)
}

const translations = {
  en: {
    seo: {
      title: 'MamaTogether | Parenting Insights & Child Psychology Blog',
      description: 'Expert parenting advice, child psychology insights, and practical tips for Iranian mothers. Discover evidence-based guidance on child development, behavior management, and maternal mental health.'
    },
    header: {
      title: 'Parenting <strong>Wisdom</strong> & Child Psychology Insights',
      text: 'Evidence-based guidance for Iranian mothers. From managing tantrums to understanding child development, find practical solutions backed by child psychology experts.'
    }
  },
  fa: {
    seo: {
      title: 'هم‌پای مادر | وبلاگ روانشناسی کودک و تربیت فرزند',
      description: 'مشاوره تخصصی تربیت فرزند، بینش‌های روانشناسی کودک و نکات کاربردی برای مادران ایرانی. راهنمایی‌های مبتنی بر شواهد درباره رشد کودک، مدیریت رفتار و سلامت روان مادر.'
    },
    header: {
      title: '<strong>دانش</strong> تربیت و روانشناسی کودک',
      text: 'راهنمایی‌های مبتنی بر شواهد برای مادران ایرانی. از مدیریت قشقرق تا درک رشد کودک، راهکارهای عملی با پشتیبانی متخصصان روانشناسی کودک بیابید.'
    }
  }
}

const currentTranslations = translations[lang as keyof typeof translations] || translations.en

const allPosts = await getCollection('blog')

export async function getStaticPaths() {
  return [{ params: { lang: 'en' } }, { params: { lang: 'fa' } }]
}
---

<Layout title={currentTranslations.seo.title} description={currentTranslations.seo.description} lang={lang}>
  <Hero title={currentTranslations.header.title} text={currentTranslations.header.text} />
  <BlogPosts data={allPosts} currentTag={undefined} />
  <slot />
</Layout>
